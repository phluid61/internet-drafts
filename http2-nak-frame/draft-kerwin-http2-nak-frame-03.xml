<?xml version="1.0" encoding="UTF-8"?>
  <?xml-stylesheet type="text/xsl" href="rfc2629.xslt" ?>
  <!-- generated by https://github.com/cabo/kramdown-rfc2629 version 1.2.9 -->

<!DOCTYPE rfc SYSTEM "rfc2629.dtd" [
]>

<?rfc toc="yes"?>
<?rfc tocindent="yes"?>
<?rfc sortrefs="yes"?>
<?rfc symrefs="yes"?>
<?rfc strict="yes"?>
<?rfc compact="yes"?>
<?rfc comments="yes"?>
<?rfc inline="yes"?>

<rfc ipr="trust200902" docName="draft-kerwin-http2-nak-frame-02" category="std">

  <front>
    <title abbrev="http2-nak-frame">HTTP/2 "Dropped Frame" Frame</title>

    <author initials="M." surname="Kerwin" fullname="Matthew Kerwin">
      <organization></organization>
      <address>
        <email>matthew@kerwin.net.au</email>
        <uri>https://matthew.kerwin.net.au/</uri>
      </address>
    </author>

    <date year="2019"/>

    <area>Applications and Real-Time</area>
    
    <keyword>HTTP</keyword> <keyword>H2</keyword>

    <abstract>


<t>This document defines an extension to the Hypertext Transfer Protocol Version 2 (HTTP/2) that
allows an endpoint to signal to its peer that an unsupported extension frame was discarded.</t>



    </abstract>


    <note title="Note to Readers">


<t>The issues list for this draft can be found at <eref target="https://github.com/phluid61/internet-drafts/labels/HTTP%2F2%20NAK%20Frame">https://github.com/phluid61/internet-drafts/labels/HTTP%2F2%20NAK%20Frame</eref></t>

<t>The most recent (often unpublished) draft is at <eref target="https://phluid61.github.io/internet-drafts/http2-nak-frame/">https://phluid61.github.io/internet-drafts/http2-nak-frame/</eref></t>


    </note>


  </front>

  <middle>


<section anchor="introduction" title="Introduction">

<t>Out of the box, the Hypertext Transfer Protocol Version 2 (HTTP/2) <xref target="RFC7540"/> makes provision for
extension frames to be sent on a connection, with or without prior agreement from either peer, with
the assertion that “implementations MUST discard frames that have unknown or unsupported types”
(<xref target="RFC7540"/>, Section 5.5).  However it can be useful to explicitly notify the peer if such a frame
is discarded.</t>

<t>This document defines an extension to HTTP/2 that allows a peer to signal that a received frame
was discarded, without altering the stream or connection state (<xref target="RFC7540"/>, Section 5.1), and in
particular without triggering an error condition.</t>

<section anchor="notational-conventions" title="Notational Conventions">

<t>The key words “MUST”, “MUST NOT”, “REQUIRED”, “SHALL”, “SHALL
NOT”, “SHOULD”, “SHOULD NOT”, “RECOMMENDED”, “NOT RECOMMENDED”,
“MAY”, and “OPTIONAL” in this document are to be interpreted as
described in BCP 14 <xref target="RFC2119"/> <xref target="RFC8174"/> when, and only when, they
appear in all capitals, as shown here.</t>

</section>
</section>
<section anchor="additions" title="Additions to HTTP/2">

<t>This document introduces a new HTTP/2 frame type (<xref target="RFC7540"/>, Section 11.2).</t>

<section anchor="dropped-frame" title="DROPPED_FRAME">

<t><cref anchor="NOTE-1" source="MK">This is an experimental value; if standardised, a permanent value will be assigned.</cref></t>

<t>DROPPED_FRAME frames (type code=0xf1) can be sent on a connection at any time after the
connection preface except in the middle of a header block (<xref target="RFC7540"/>, Section 4.3) to indicate
that a received extension frame was discarded without any other action being taken.</t>

<figure title="DROPPED_FRAME Frame Payload"><artwork><![CDATA[
  +---------------+
  |   Type (8)    |
  +---------------+
]]></artwork></figure>

<t>The DROPPED_FRAME frame contains a single 8-bit integer containing the value of the Type field
from the discarded frame.</t>

<t>The DROPPED_FRAME frame does not define any flags.</t>

<t>An endpoint SHOULD send a DROPPED_FRAME frame for an unknown or unsupported extension frame type
the first time it discards a frame of that type.</t>

<t>An endpoint MAY send a DROPPED_FRAME frame for a particular frame type only once, even if it
discards multiple frames of that type.</t>

<t>An endpoint that receives a DROPPED_FRAME frame ought to take it as an indication that the
extension is not supported by the peer, and MAY subsequently choose not to send further frames of
that type or to attempt extension negotiation with the peer.</t>

<t>Receipt of a DROPPED_FRAME frame does not necessarily mean that all frames on that connection with
the discarded type will be discarded in future.  A transparent intermediary that forwards an
extension frame in one direction and a corresponding DROPPED_FRAME frame in the other direction
MUST NOT intercept future frames of that type and preemptively reply with a DROPPED_FRAME frame.</t>

<t>DROPPED_FRAME frames are not associated with any individual stream.  If a DROPPED_FRAME frame is
received with a stream identifier field value other than 0x0, the recipient MUST respond with a
connection error (<xref target="RFC7540"/>, Section 5.4.1) of type PROTOCOL_ERROR.</t>

<t>Receipt of a DROPPED_FRAME frame with a length field value other than 1 MUST be treated as a
connection error (<xref target="RFC7540"/>, Section 5.4.1) of type FRAME_SIZE_ERROR.</t>

<t>An endpoint MUST NOT send a DROPPED_FRAME frame with a Type of DROPPED_FRAME (0xf1).  If a
DROPPED_FRAME frame is received with a Type field value of 0xf1, the recipient MUST respond with
a connection error (<xref target="RFC7540"/>, Section 5.4.1) of type PROTOCOL_ERROR.</t>

<t>Likewise, an endpoint MUST NOT send a DROPPED_FRAME frame for a type it does not discard – including
the frame types defined in <xref target="RFC7540"/>, Section 6, unless otherwise negotiated.  If a
DROPPED_FRAME frame is received for a type that can not be discarded by the sending peer, the
recipient MUST respond with a connection error (<xref target="RFC7540"/>, Section 5.4.1) of type PROTOCOL_ERROR.</t>

<t>Extensions that define new HTTP/2 frame types MAY specify behaviours in response to DROPPED_FRAME
frames with those types, however extensions that change the semantics of existing protocol
components, including those defined in this document, MUST be negotiated before being used
(<xref target="RFC7540"/>, Section 5.5).</t>

</section>
</section>
<section anchor="security-considerations" title="Security Considerations">

<t>Receipt of a DROPPED_FRAME frame does not guarantee that the sending peer will send one for
every frame type it drops, and the absence of a DROPPED_FRAME frame does not imply that the peer
has not discarded a frame.  Implementations MUST NOT depend on the use of DROPPED_FRAME frames to
indicate acceptance or rejection of extension frames.</t>

</section>
<section anchor="iana" title="IANA Considerations">

<t>This document updates the registry for frame types in the “Hypertext Transfer Protocol (HTTP) 2
Parameters” section.</t>

<section anchor="http2-frame-type-registry-update" title="HTTP/2 Frame Type Registry Update">

<t>This document updates the “HTTP/2 Frame Type” registry (<xref target="RFC7540"/>, Section 11.2).  The entries
in the following table are registered by this document.</t>

<texttable>
      <ttcol align='left'>Frame Type</ttcol>
      <ttcol align='left'>Code</ttcol>
      <ttcol align='left'>Section</ttcol>
      <c>DROPPED_FRAME</c>
      <c>TBD</c>
      <c><xref target="dropped-frame"/></c>
</texttable>

</section>
</section>


  </middle>

  <back>

    <references title='Normative References'>





<reference  anchor="RFC2119" target='https://www.rfc-editor.org/info/rfc2119'>
<front>
<title>Key words for use in RFCs to Indicate Requirement Levels</title>
<author initials='S.' surname='Bradner' fullname='S. Bradner'><organization /></author>
<date year='1997' month='March' />
<abstract><t>In many standards track documents several words are used to signify the requirements in the specification.  These words are often capitalized. This document defines these words as they should be interpreted in IETF documents.  This document specifies an Internet Best Current Practices for the Internet Community, and requests discussion and suggestions for improvements.</t></abstract>
</front>
<seriesInfo name='BCP' value='14'/>
<seriesInfo name='RFC' value='2119'/>
<seriesInfo name='DOI' value='10.17487/RFC2119'/>
</reference>



<reference  anchor="RFC7540" target='https://www.rfc-editor.org/info/rfc7540'>
<front>
<title>Hypertext Transfer Protocol Version 2 (HTTP/2)</title>
<author initials='M.' surname='Belshe' fullname='M. Belshe'><organization /></author>
<author initials='R.' surname='Peon' fullname='R. Peon'><organization /></author>
<author initials='M.' surname='Thomson' fullname='M. Thomson' role='editor'><organization /></author>
<date year='2015' month='May' />
<abstract><t>This specification describes an optimized expression of the semantics of the Hypertext Transfer Protocol (HTTP), referred to as HTTP version 2 (HTTP/2).  HTTP/2 enables a more efficient use of network resources and a reduced perception of latency by introducing header field compression and allowing multiple concurrent exchanges on the same connection.  It also introduces unsolicited push of representations from servers to clients.</t><t>This specification is an alternative to, but does not obsolete, the HTTP/1.1 message syntax.  HTTP's existing semantics remain unchanged.</t></abstract>
</front>
<seriesInfo name='RFC' value='7540'/>
<seriesInfo name='DOI' value='10.17487/RFC7540'/>
</reference>



<reference  anchor="RFC8174" target='https://www.rfc-editor.org/info/rfc8174'>
<front>
<title>Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words</title>
<author initials='B.' surname='Leiba' fullname='B. Leiba'><organization /></author>
<date year='2017' month='May' />
<abstract><t>RFC 2119 specifies common key words that may be used in protocol  specifications.  This document aims to reduce the ambiguity by clarifying that only UPPERCASE usage of the key words have the  defined special meanings.</t></abstract>
</front>
<seriesInfo name='BCP' value='14'/>
<seriesInfo name='RFC' value='8174'/>
<seriesInfo name='DOI' value='10.17487/RFC8174'/>
</reference>




    </references>



<section anchor="changelog" title="Changelog">

<t>Since -01:</t>

<t><list style="symbols">
  <t>use experimental value for frame ID</t>
  <t>forbid sending a DROPPED_FRAME for any frame that isn’t dropped</t>
</list></t>

<t>Since -00:</t>

<t><list style="symbols">
  <t>Largely editorial; clarifications about when a frame can be received and what it
can reasonably contain.</t>
</list></t>

</section>


  </back>

<!-- ##markdown-source:
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
WlaDKODzP0LJ1A4rGQAA

-->

</rfc>

